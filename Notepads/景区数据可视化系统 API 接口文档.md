# 景区数据可视化系统 API 接口文档

## 目录

1. [用户管理接口](#用户管理接口)
2. [景区数据接口](#景区数据接口)
3. [管理员接口](#管理员接口)

## 用户管理接口

### 1. 用户登录

- **功能**: 用户身份验证并返回令牌
- **请求方式**: POST
- **路径**: `/api/login/`
- **权限**: 无需认证
- **请求参数**:
  ```json
  {
    "username": "用户名",
    "password": "密码"
  }
  ```
- **响应格式**:
  ```json
  {
    "token": "认证令牌",
    "user_id": 1,
    "username": "用户名",
    "email": "邮箱",
    "avatar": "头像URL",
    "location": "所在地",
    "is_admin": false
  }
  ```
- **状态码**:
  - 200: 登录成功
  - 400: 登录失败（用户名或密码错误）

### 2. 用户注册

- **功能**: 创建新用户账号
- **请求方式**: POST
- **路径**: `/api/register/`
- **权限**: 无需认证
- **请求参数**:
  ```json
  {
    "username": "用户名",
    "password": "密码",
    "email": "邮箱"
  }
  ```
- **响应格式**:
  ```json
  {
    "success": true,
    "message": "注册成功"
  }
  ```
- **状态码**:
  - 201: 创建成功
  - 400: 注册失败（用户名已存在或其他验证错误）

### 3. 更新用户资料

- **功能**: 更新当前用户资料
- **请求方式**: PUT
- **路径**: `/api/users/profile/`
- **权限**: 需要用户认证
- **请求参数**:
  ```json
  {
    "avatar": "头像URL",
    "location": "所在地"
  }
  ```
- **响应格式**:
  ```json
  {
    "success": true,
    "user": {
      "id": 1,
      "username": "用户名",
      "email": "邮箱",
      "avatar": "头像URL",
      "location": "所在地",
      "isAdmin": false
    }
  }
  ```
- **状态码**:
  - 200: 更新成功
  - 400: 更新失败（验证错误）

### 4. 景区收藏/取消收藏

- **功能**: 添加或移除收藏的景区
- **请求方式**: POST
- **路径**: `/api/favorites/toggle/`
- **权限**: 需要用户认证
- **请求参数**:
  ```json
  {
    "scenic_id": "景区ID"
  }
  ```
- **响应格式**:
  ```json
  {
    "success": true,
    "is_favorite": true  // true表示添加收藏，false表示取消收藏
  }
  ```
- **状态码**:
  - 200: 操作成功
  - 400: 操作失败（参数缺失）

### 5. 获取用户收藏列表

- **功能**: 获取当前用户收藏的景区列表
- **请求方式**: GET
- **路径**: `/api/favorites/`
- **权限**: 需要用户认证
- **请求参数**: 无
- **响应格式**:
  ```json
  [
    {
      "id": 1,
      "user": 1,
      "scenic_id": "景区ID",
      "created_at": "收藏时间"
    }
  ]
  ```
- **状态码**:
  - 200: 获取成功

## 景区数据接口

### 1. 省份景区分布数据

- **功能**: 获取各省份景区分布数据
- **请求方式**: GET
- **路径**: `/api/data/province-distribution/`
- **权限**: 无需认证
- **请求参数**: 无
- **响应格式**:
  ```json
  [
    {
      "name": "省份名称",
      "value": 景区数量,
      "scenics": [
        {
          "id": "景区ID",
          "name": "景区名称",
          "longitude": 经度,
          "latitude": 纬度
        }
      ]
    }
  ]
  ```
- **状态码**:
  - 200: 获取成功

### 2. 景区等级与分类数据

- **功能**: 获取景区等级和分类的统计数据
- **请求方式**: GET
- **路径**: `/api/data/scenic-levels/`
- **权限**: 无需认证
- **请求参数**: 无
- **响应格式**:
  ```json
  {
    "scenic_levels": [
      { "name": "等级名称", "value": 数量 }
    ],
    "scenic_level_prices": [
      { "name": "等级名称", "value": 平均价格 }
    ],
    "museum_levels": [ ... ],
    "museum_level_prices": [ ... ],
    // 其他类型景区数据
  }
  ```
- **状态码**:
  - 200: 获取成功

### 3. 门票价格数据

- **功能**: 获取各类型景区门票价格统计数据
- **请求方式**: GET
- **路径**: `/api/data/ticket-prices/`
- **权限**: 无需认证
- **请求参数**: 无
- **响应格式**:
  ```json
  {
    "scenicLevels": [
      {
        "name": "等级名称",
        "min": 最低价格,
        "max": 最高价格,
        "avg": 平均价格,
        "median": 中位价格
      }
    ],
    "museumLevels": [ ... ],
    // 其他类型景区价格数据
  }
  ```
- **状态码**:
  - 200: 获取成功

### 4. 开放时间数据

- **功能**: 获取景区开放时间分布数据
- **请求方式**: GET
- **路径**: `/api/data/open-times/`
- **权限**: 无需认证
- **请求参数**: 无
- **响应格式**: 根据视图实现返回相关数据
- **状态码**:
  - 200: 获取成功

### 5. 评论情感分析数据

- **功能**: 获取景区评论情感分析数据
- **请求方式**: GET
- **路径**: `/api/data/comment-analysis/`
- **权限**: 无需认证
- **请求参数**: 无
- **响应格式**: 根据视图实现返回相关数据
- **状态码**:
  - 200: 获取成功

### 6. 景区词云数据

- **功能**: 获取特定景区的词云数据
- **请求方式**: GET
- **路径**: `/api/data/word-cloud/<str:scenic_id>/`
- **权限**: 无需认证
- **请求参数**: 无 (scenic_id在URL中)
- **响应格式**: 根据视图实现返回相关词云数据
- **状态码**:
  - 200: 获取成功

### 7. 交通方式数据

- **功能**: 获取景区交通方式统计数据
- **请求方式**: GET
- **路径**: `/api/data/transportation/`
- **权限**: 无需认证
- **请求参数**: 无
- **响应格式**: 根据视图实现返回相关交通数据
- **状态码**:
  - 200: 获取成功

### 8. 景区搜索

- **功能**: 根据关键词搜索景区
- **请求方式**: GET
- **路径**: `/api/scenic/search/`
- **权限**: 无需认证
- **请求参数**: 
  - query: 搜索关键词
  - filters: 可选的筛选条件
- **响应格式**: 返回匹配的景区列表
- **状态码**:
  - 200: 获取成功

### 9. 筛选选项数据

- **功能**: 获取景区筛选选项数据
- **请求方式**: GET
- **路径**: `/api/data/filter-options/`
- **权限**: 无需认证
- **请求参数**: 无
- **响应格式**: 返回可用的筛选选项数据
- **状态码**:
  - 200: 获取成功

### 10. 景区详情

- **功能**: 获取特定景区的详细信息
- **请求方式**: GET
- **路径**: `/api/scenic/<str:pk>/`
- **权限**: 无需认证
- **请求参数**: 无 (pk在URL中)
- **响应格式**: 返回景区详情信息
- **状态码**:
  - 200: 获取成功
  - 404: 景区不存在

## 管理员接口

### 1. 用户管理

- **功能**: 获取所有用户信息（仅管理员）
- **请求方式**: GET
- **路径**: `/api/admin/users/`
- **权限**: 需要管理员权限
- **请求参数**: 无
- **响应格式**: 返回用户列表信息
- **状态码**:
  - 200: 获取成功
  - 403: 权限不足

### 2. 用户操作记录

- **功能**: 获取所有用户操作记录（仅管理员）
- **请求方式**: GET
- **路径**: `/api/admin/user-records/`
- **权限**: 需要管理员权限
- **请求参数**: 无
- **响应格式**: 返回用户操作记录列表
- **状态码**:
  - 200: 获取成功
  - 403: 权限不足

---

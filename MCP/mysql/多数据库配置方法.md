 # MySQL MCP 多数据库配置方法

## 问题

Smithery MySQL MCP 服务器一次只能连接到一个数据库。如果需要在多个数据库之间切换，我们需要有效的策略。

## 解决方案

### 方法一：使用不同的配置命令

为每个数据库创建单独的连接命令：

```powershell
# 连接到 scenic_area 数据库
npx -y @smithery/cli@latest run mysql-mcp-server --client cursor --config "{\"mysqlHost\":\"localhost\",\"mysqlPort\":3306,\"mysqlUser\":\"root\",\"mysqlPassword\":\"3143285505\",\"mysqlDatabase\":\"scenic_area\"}"

# 连接到 hierarchy_ticketanalysis 数据库
npx -y @smithery/cli@latest run mysql-mcp-server --client cursor --config "{\"mysqlHost\":\"localhost\",\"mysqlPort\":3306,\"mysqlUser\":\"root\",\"mysqlPassword\":\"3143285505\",\"mysqlDatabase\":\"hierarchy_ticketanalysis\"}"
```

每次需要切换数据库时，停止当前的MCP服务器（通常按Ctrl+C），然后运行另一个命令。

### 方法二：创建PowerShell函数

在PowerShell配置文件中创建函数以简化切换过程：

```powershell
function Connect-ScenicAreaDB {
    $config = @{
        mysqlHost = "localhost"
        mysqlPort = 3306
        mysqlUser = "root"
        mysqlPassword = "3143285505"
        mysqlDatabase = "scenic_area"
    } | ConvertTo-Json -Compress
    
    npx -y @smithery/cli@latest run mysql-mcp-server --client cursor --config $config
}

function Connect-TicketAnalysisDB {
    $config = @{
        mysqlHost = "localhost"
        mysqlPort = 3306
        mysqlUser = "root"
        mysqlPassword = "3143285505"
        mysqlDatabase = "hierarchy_ticketanalysis"
    } | ConvertTo-Json -Compress
    
    npx -y @smithery/cli@latest run mysql-mcp-server --client cursor --config $config
}
```

### 方法三：使用数据库查询前缀

如果两个数据库在同一MySQL实例中，可以在查询时直接指定数据库（前提是MySQL用户对两个数据库都有访问权限）：

```sql
-- 查询scenic_area数据库
SELECT * FROM scenic_area.your_table LIMIT 10;

-- 查询hierarchy_ticketanalysis数据库
SELECT * FROM hierarchy_ticketanalysis.your_table LIMIT 10;
```

### 方法四：使用批处理文件

创建简单的批处理文件以便快速切换：

#### connect_scenic.bat
```batch
@echo off
echo 正在连接到 scenic_area 数据库...
npx -y @smithery/cli@latest run mysql-mcp-server --client cursor --config "{\"mysqlHost\":\"localhost\",\"mysqlPort\":3306,\"mysqlUser\":\"root\",\"mysqlPassword\":\"3143285505\",\"mysqlDatabase\":\"scenic_area\"}"
```

#### connect_ticket.bat
```batch
@echo off
echo 正在连接到 hierarchy_ticketanalysis 数据库...
npx -y @smithery/cli@latest run mysql-mcp-server --client cursor --config "{\"mysqlHost\":\"localhost\",\"mysqlPort\":3306,\"mysqlUser\":\"root\",\"mysqlPassword\":\"3143285505\",\"mysqlDatabase\":\"hierarchy_ticketanalysis\"}"
```

## 连接问题排查

如果您无法连接到MySQL服务器，请检查：

1. MySQL服务是否正在运行（使用`Get-Service -Name *mysql*`检查）
2. 连接信息是否正确（主机、端口、用户名、密码）
3. 指定的数据库是否存在
4. 用户是否有访问数据库的权限
5. 防火墙是否允许MySQL连接

## 其他注意事项

- 每次切换数据库时，需要停止当前运行的MCP服务器
- 为了安全起见，建议为MCP连接创建一个具有有限权限的专用数据库用户
- 密码不应以明文形式存储在脚本中，可以考虑使用环境变量或安全的凭据存储